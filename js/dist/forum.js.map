{"version":3,"file":"forum.js","mappings":"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","sources":["webpack://@huseyinfiliz/custom-profile-page/webpack/bootstrap","webpack://@huseyinfiliz/custom-profile-page/webpack/runtime/compat get default export","webpack://@huseyinfiliz/custom-profile-page/webpack/runtime/define property getters","webpack://@huseyinfiliz/custom-profile-page/webpack/runtime/hasOwnProperty shorthand","webpack://@huseyinfiliz/custom-profile-page/external root \"flarum.core.compat['common/app']\"","webpack://@huseyinfiliz/custom-profile-page/./src/common/index.ts","webpack://@huseyinfiliz/custom-profile-page/external root \"flarum.core.compat['forum/app']\"","webpack://@huseyinfiliz/custom-profile-page/./node_modules/@babel/runtime/helpers/esm/setPrototypeOf.js","webpack://@huseyinfiliz/custom-profile-page/./node_modules/@babel/runtime/helpers/esm/inheritsLoose.js","webpack://@huseyinfiliz/custom-profile-page/external root \"flarum.core.compat['common/Model']\"","webpack://@huseyinfiliz/custom-profile-page/./src/forum/models/CustomProfilePage.ts","webpack://@huseyinfiliz/custom-profile-page/external root \"flarum.core.compat['common/extend']\"","webpack://@huseyinfiliz/custom-profile-page/external root \"flarum.core.compat['forum/components/UserPage']\"","webpack://@huseyinfiliz/custom-profile-page/external root \"flarum.core.compat['common/components/LinkButton']\"","webpack://@huseyinfiliz/custom-profile-page/external root \"flarum.core.compat['common/components/LoadingIndicator']\"","webpack://@huseyinfiliz/custom-profile-page/external root \"flarum.core.compat['common/components/Button']\"","webpack://@huseyinfiliz/custom-profile-page/external root \"flarum.core.compat['common/components/Modal']\"","webpack://@huseyinfiliz/custom-profile-page/external root \"flarum.core.compat['common/components/TextEditor']\"","webpack://@huseyinfiliz/custom-profile-page/external root \"flarum.core.compat['common/utils/Stream']\"","webpack://@huseyinfiliz/custom-profile-page/./src/forum/components/EditCustomPageModal.ts","webpack://@huseyinfiliz/custom-profile-page/./src/forum/pages/CustomProfilePage.tsx","webpack://@huseyinfiliz/custom-profile-page/./src/forum/index.ts","webpack://@huseyinfiliz/custom-profile-page/./src/forum/addUserProfilePage.tsx"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/app'];","import app from 'flarum/common/app';\n\napp.initializers.add('huseyinfiliz/custom-profile-page', () => {\n  // Common initialization - currently empty\n  // Models are registered in forum/admin initializers\n});","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/app'];","function _setPrototypeOf(t, e) {\n  return _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function (t, e) {\n    return t.__proto__ = e, t;\n  }, _setPrototypeOf(t, e);\n}\nexport { _setPrototypeOf as default };","import setPrototypeOf from \"./setPrototypeOf.js\";\nfunction _inheritsLoose(t, o) {\n  t.prototype = Object.create(o.prototype), t.prototype.constructor = t, setPrototypeOf(t, o);\n}\nexport { _inheritsLoose as default };","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/Model'];","import Model from 'flarum/common/Model';\n\nexport default class CustomProfilePage extends Model {\n  content = Model.attribute<string>('content');\n  updatedAt = Model.attribute('updatedAt', Model.transformDate);\n  \n  user = Model.hasOne('user');\n}","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/extend'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/UserPage'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/LinkButton'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/LoadingIndicator'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Button'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Modal'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/TextEditor'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/utils/Stream'];","import app from 'flarum/forum/app';\nimport Modal from 'flarum/common/components/Modal';\nimport Button from 'flarum/common/components/Button';\nimport TextEditor from 'flarum/common/components/TextEditor';  // ✅ Flarum editörü\nimport Stream from 'flarum/common/utils/Stream';\n\nexport default class EditCustomPageModal extends Modal {\n  contentText!: Stream<string>;  // ✅ İsim değişti (content yerine contentText)\n  loading: boolean = false;\n  useEditor: boolean = false;     // ✅ Editör kullanılacak mı?\n\n  oninit(vnode: any) {\n    super.oninit(vnode);\n    \n    // İçeriği Stream olarak başlat\n    this.contentText = Stream(this.attrs.customPage?.content() || '');\n    \n    // Format kontrolü - markdown ise editör kullan\n    const format = app.forum.attribute<string>('huseyinfiliz-custom-profile-page.content_format') || 'markdown';\n    this.useEditor = format === 'markdown';\n  }\n\n  className() {\n    return 'EditCustomPageModal Modal--large';\n  }\n\n  title() {\n    return app.translator.trans('huseyinfiliz-custom-profile-page.forum.edit_modal.title');\n  }\n\n  content() {  // ✅ Modal'ın content metodu\n    return m('.Modal-body', [\n      m('.Form', [\n        m('.Form-group', [\n          m('label', app.translator.trans('huseyinfiliz-custom-profile-page.forum.edit_modal.content_label')),\n          \n          // ✅ Markdown ise Flarum editörünü kullan\n          this.useEditor ? this.renderEditor() : this.renderTextarea()\n        ]),\n\n        m('.Form-group', [\n          Button.component(\n            {\n              type: 'submit',\n              className: 'Button Button--primary',\n              loading: this.loading,\n              disabled: this.loading,\n            },\n            app.translator.trans('huseyinfiliz-custom-profile-page.forum.edit_modal.submit_button')\n          )\n        ])\n      ])\n    ]);\n  }\n\n  renderEditor() {\n    // ✅ Flarum'un TextEditor'ünü kullan\n    return m(TextEditor, {\n      composer: this,\n      submitLabel: app.translator.trans('huseyinfiliz-custom-profile-page.forum.edit_modal.submit_button'),\n      placeholder: app.translator.trans('huseyinfiliz-custom-profile-page.forum.edit_modal.content_placeholder'),\n      onchange: (value: string) => {\n        this.contentText(value);\n      },\n      onsubmit: () => {\n        this.onsubmit(new Event('submit') as any);\n      },\n      value: this.contentText(),\n      disabled: this.loading,\n    });\n  }\n\n  renderTextarea() {\n    // ✅ Basit textarea (HTML veya Text formatı için)\n    return m('textarea.FormControl', {\n      rows: 15,\n      value: this.contentText(),\n      oninput: (e: any) => {\n        this.contentText(e.target.value);\n      },\n      placeholder: app.translator.trans('huseyinfiliz-custom-profile-page.forum.edit_modal.content_placeholder'),\n      disabled: this.loading,\n    });\n  }\n\n  onsubmit(e: Event) {\n    e.preventDefault();\n\n    if (this.loading) return;\n\n    this.loading = true;\n\n    const userId = this.attrs.user.id();\n    const data = {\n      type: 'custom-profile-pages',\n      attributes: {\n        content: this.contentText(),  // ✅ Stream değeri\n      },\n    };\n\n    const method = this.attrs.customPage ? 'PATCH' : 'POST';\n    const url = `${app.forum.attribute('apiUrl')}/users/${userId}/custom-page`;\n\n    app.request({\n      method,\n      url,\n      body: { data },\n    })\n      .then(() => {\n        this.loading = false;\n        this.hide();\n        this.attrs.onSave();\n        m.redraw();\n      })\n      .catch((error) => {\n        console.error('Save error:', error);\n        this.loading = false;\n        \n        // Hata mesajı göster\n        app.alerts.show(\n          { type: 'error' },\n          app.translator.trans('huseyinfiliz-custom-profile-page.forum.edit_modal.error')\n        );\n        \n        m.redraw();\n      });\n  }\n}","import app from 'flarum/forum/app';\nimport UserPage from 'flarum/forum/components/UserPage';\nimport LoadingIndicator from 'flarum/common/components/LoadingIndicator';\nimport Button from 'flarum/common/components/Button';\nimport EditCustomPageModal from '../components/EditCustomPageModal';\n\nexport default class CustomProfilePage extends UserPage {\n    loading: boolean = false;\n    customPage: any = null;\n    error: string | null = null;\n\n    oninit(vnode) {\n        super.oninit(vnode);\n        this.loading = true;\n        this.loadUser(this.attrs.username);\n        \n        // Debug\n        console.log('CustomProfilePage initialized', this.attrs);\n    }\n\n    oncreate(vnode) {\n        super.oncreate(vnode);\n        \n        // User yüklendikten sonra custom page'i yükle\n        if (this.user) {\n            this.loadCustomPage();\n        } else {\n            // User henüz yüklenmemişse bekle\n            setTimeout(() => {\n                if (this.user) {\n                    this.loadCustomPage();\n                }\n            }, 100);\n        }\n    }\n\n    content() {\n        // User kontrolü\n        if (!this.user) {\n            console.log('Waiting for user...');\n            return m('.CustomProfilePage', m(LoadingIndicator));\n        }\n\n        if (this.loading) {\n            return m('.CustomProfilePage', [\n                m('h2', this.user.displayName() + \"'s Custom Page\"),\n                m(LoadingIndicator)\n            ]);\n        }\n\n        if (this.error) {\n            return m('.CustomProfilePage', \n                m('.Alert.Alert--error', this.error)\n            );\n        }\n\n        const canEdit = app.session.user?.id() === this.user.id() && \n                       app.forum.attribute('canEditOwnCustomPage');\n        const content = this.customPage?.content();\n        const format = app.forum.attribute('huseyinfiliz-custom-profile-page.content_format') || 'markdown';\n\n        console.log('Rendering content', { content, format, canEdit });\n\n        return m('.CustomProfilePage', [\n            canEdit && m('.CustomProfilePage-actions',\n                m(Button, {\n                    className: 'Button Button--primary',\n                    icon: 'fas fa-edit',\n                    onclick: () => {\n                        console.log('Opening edit modal');\n                        app.modal.show(EditCustomPageModal, {\n                            user: this.user,\n                            customPage: this.customPage,\n                            onSave: () => {\n                                console.log('Modal saved, reloading');\n                                this.loadCustomPage();\n                            }\n                        });\n                    }\n                }, app.translator.trans('huseyinfiliz-custom-profile-page.forum.profile_tab.edit_button'))\n            ),\n\n            m('.CustomProfilePage-content',\n                content ? this.renderContent(content, format) : this.renderEmpty(canEdit)\n            )\n        ]);\n    }\n\n    loadCustomPage() {\n        if (!this.user) {\n            console.log('No user yet, waiting...');\n            setTimeout(() => this.loadCustomPage(), 100);\n            return;\n        }\n\n        this.loading = true;\n        this.error = null;\n\n        console.log('Loading custom page for user:', this.user.id());\n\n        app.request({\n            method: 'GET',\n            url: app.forum.attribute('apiUrl') + '/users/' + this.user.id() + '/custom-page',\n        })\n        .then((response) => {\n            console.log('Custom page loaded:', response);\n            if (response.data) {\n                this.customPage = app.store.pushPayload(response);\n            }\n            this.loading = false;\n            m.redraw();\n        })\n        .catch((error) => {\n            console.error('Custom page load error:', error);\n            if (error.status === 404) {\n                console.log('No custom page yet (404)');\n                this.customPage = null;\n            } else {\n                console.error('Real error:', error);\n                this.error = 'Failed to load custom page';\n            }\n            this.loading = false;\n            m.redraw();\n        });\n    }\n\n    renderContent(text, format) {\n        if (format === 'html') {\n            return m.trust(text);\n        }\n        \n        if (format === 'markdown') {\n            const html = text\n                .replace(/\\*\\*(.*?)\\*\\*/g, '<strong>$1</strong>')\n                .replace(/\\*(.*?)\\*/g, '<em>$1</em>')\n                .replace(/\\n/g, '<br>');\n            return m.trust(html);\n        }\n        \n        return m('pre', text);\n    }\n\n    renderEmpty(canEdit) {\n        return m('.CustomProfilePage-empty', [\n            m('p', app.translator.trans('huseyinfiliz-custom-profile-page.forum.profile_tab.empty')),\n            canEdit && m('p.help-text', 'Click \"Edit\" to create your custom page')\n        ]);\n    }\n}","import app from 'flarum/forum/app';\nimport CustomProfilePage from './models/CustomProfilePage';\nimport addUserProfilePage from './addUserProfilePage';\n\napp.initializers.add('huseyinfiliz/custom-profile-page', () => {\n  // Model kaydet\n  app.store.models['custom-profile-pages'] = CustomProfilePage;\n\n  // Route ve navigation ekle\n  addUserProfilePage();\n});","import { extend } from 'flarum/common/extend';\nimport app from 'flarum/forum/app';\nimport UserPage from 'flarum/forum/components/UserPage';\nimport LinkButton from 'flarum/common/components/LinkButton';\nimport CustomProfilePageComponent from './pages/CustomProfilePage';\n\nexport default function addUserProfilePage() {\n  // Route kaydet\n  app.routes['user.customPage'] = {\n    path: '/u/:username/customPage',\n    component: CustomProfilePageComponent,\n  };\n\n  // Navigation ekle\n  extend(UserPage.prototype, 'navItems', function (items) {\n    const user = this.user;\n    if (!user) return;\n\n    const canView = app.forum.attribute('canViewCustomPage');\n    const canEdit = app.session.user?.id() === user.id() && \n                   app.forum.attribute('canEditOwnCustomPage');\n\n    if (canView || canEdit) {\n      const tabTitle = app.forum.attribute('huseyinfiliz-custom-profile-page.tab_title') || 'Custom Page';\n      const tabIcon = app.forum.attribute('huseyinfiliz-custom-profile-page.tab_icon') || 'fas fa-file-alt';\n\n      items.add(\n        'customPageLink',\n        LinkButton.component(\n          {\n            href: app.route('user.customPage', { username: user.slug() }),\n            name: 'custompage',\n            icon: tabIcon,\n          },\n          tabTitle\n        ),\n        85\n      );\n    }\n  });\n}"],"names":["__webpack_require__","module","getter","__esModule","d","a","exports","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","flarum","core","compat","app","add","_setPrototypeOf","t","e","setPrototypeOf","bind","__proto__","_inheritsLoose","create","constructor","CustomProfilePage","_Model","_this","_len","arguments","length","args","Array","_key","apply","concat","content","Model","updatedAt","user","EditCustomPageModal","_Modal","contentText","loading","useEditor","_proto","oninit","vnode","_this$attrs$customPag","this","Stream","attrs","customPage","format","attribute","className","title","trans","m","renderEditor","renderTextarea","Button","type","disabled","_this2","TextEditor","composer","submitLabel","placeholder","onchange","value","onsubmit","Event","_this3","rows","oninput","target","_this4","preventDefault","userId","id","data","attributes","method","url","body","then","hide","onSave","redraw","error","console","show","Modal","_UserPage","loadUser","username","log","oncreate","loadCustomPage","setTimeout","_app$session$user","_this$customPage","LoadingIndicator","displayName","canEdit","icon","onclick","renderContent","renderEmpty","response","pushPayload","status","text","trust","html","replace","UserPage","models","path","component","CustomProfilePageComponent","extend","items","canView","tabTitle","tabIcon","LinkButton","href","slug","name"],"sourceRoot":""}